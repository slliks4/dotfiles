#!/bin/sh

set -e

get_sink_id() {
  wpctl status |
    grep -i "$1" |
    grep -i "Audio Controller" |
    sed -E 's/.*([0-9]+)\..*/\1/' |
    head -n1
}

HEADPHONES_ID="$(get_sink_id Headphones)"
SPEAKER_ID="$(get_sink_id Speaker)"

if [ -n "$HEADPHONES_ID" ]; then
  wpctl set-default "$HEADPHONES_ID"
  notify-send "ðŸ”Š Audio" "Using Headphones"
  exit 0
fi

if [ -n "$SPEAKER_ID" ]; then
  wpctl set-default "$SPEAKER_ID"
  notify-send "ðŸ”Š Audio" "Using Speakers"
  exit 0
fi

notify-send "ðŸ”Š Audio" "No audio output detected"
exit 1

